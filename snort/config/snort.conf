# Minimal Snort 2 configuration for Docker-based IDS mode

var HOME_NET [172.28.0.0/16]
var EXTERNAL_NET any

var RULE_PATH /etc/snort/rules
var SO_RULE_PATH /etc/snort/so_rules
var PREPROC_RULE_PATH /etc/snort/preproc_rules

# Output alerts in fast format for easy parsing
output alert_fast: /var/log/snort/alert.fast

# Basic preprocessors
preprocessor stream5_global: track_tcp yes, track_udp yes
preprocessor stream5_tcp: policy linux, timeout 180
preprocessor http_inspect_server: server default profile all ports { 8080 }

# Include modular rule files
include $RULE_PATH/scan.rules
include $RULE_PATH/dos.rules
include $RULE_PATH/unauthorized.rules
